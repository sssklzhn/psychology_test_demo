# backend/create_simple_scales_mapping.py
import json

def create_simple_scales_mapping():
    """Создание упрощенного маппинга шкал для быстрого старта"""
    
    # Это упрощенный маппинг на основе типичной структуры психологических тестов
    # В реальном проекте нужно загрузить точный маппинг из Excel
    
    scales_mapping = {}
    
    # Примерные группы вопросов (нужно уточнить по реальному тесту)
    # Достоверность (Isk) - вопросы проверяющие искренность
    scales_mapping.update({i: ['Достоверность'] for i in [1, 2, 6, 11, 18, 19, 23, 26, 27, 31, 34, 39, 46, 55, 62, 66, 79]})
    
    # Аутоагрессия (Con) - вопросы о саморазрушающем поведении
    scales_mapping.update({i: ['Аутоагрессия'] for i in [4, 20, 30, 36, 50, 75, 82, 83, 87, 94, 131, 139, 156, 159]})
    
    # Ранимость (Ast) - вопросы о чувствительности
    scales_mapping.update({i: ['Ранимость'] for i in [3, 5, 7, 9, 10, 12, 13, 14, 16, 17, 21, 24, 28, 29, 32, 33, 37]})
    
    # Истероидность (Ist) - вопросы о демонстративности
    scales_mapping.update({i: ['Истероидность'] for i in [4, 40, 41, 44, 45, 48, 49, 52, 53, 56, 57, 60, 64, 65, 68, 69, 72, 73, 76, 77, 80, 81, 84, 85, 88, 89, 92, 93, 96, 97]})
    
    # Психопатическая (Psi) - вопросы об агрессии
    scales_mapping.update({i: ['Психопатическая'] for i in [4, 100, 101, 104, 105, 108, 109, 112, 113, 116, 117, 120, 121, 124, 125, 128, 129, 132, 133, 136, 137, 138, 141, 142, 145, 146, 149, 150, 153, 154]})
    
    # НПН - вопросы о нервно-психической неустойчивости
    scales_mapping.update({i: ['НПН'] for i in [4, 8, 10, 15, 20, 22, 25, 30, 32, 33, 35, 36, 37, 38, 42, 43, 47, 50, 51, 58, 60, 63, 67, 71, 74, 75, 82, 83, 86, 87, 91, 94, 95, 98, 102, 103, 106, 107, 110, 111, 114, 115, 118, 119, 122, 123, 125, 127, 128, 129, 131, 133, 135, 136, 137, 138, 139, 140, 145, 146, 148, 151, 152, 154, 155, 156, 159]})
    
    # Проверяем покрытие
    all_questions = set(range(1, 161))
    mapped_questions = set(scales_mapping.keys())
    unmapped = all_questions - mapped_questions
    
    print(f"Всего вопросов: 160")
    print(f"Вопросов с маппингом: {len(mapped_questions)}")
    print(f"Незамапленных вопросов: {len(unmapped)}")
    
    if unmapped:
        print(f"Незамапленные вопросы: {sorted(unmapped)}")
        # Добавим оставшиеся вопросы в общую категорию
        for q in unmapped:
            scales_mapping[q] = ['Общие']
    
    # Сохраняем в файл
    with open('scales_mapping.json', 'w', encoding='utf-8') as f:
        json.dump(scales_mapping, f, ensure_ascii=False, indent=2)
    
    print("\nМаппинг сохранен в scales_mapping.json")
    
    # Покажем несколько примеров
    print("\nПримеры маппинга:")
    for q in [1, 2, 3, 4, 5, 50, 100, 150]:
        print(f"Вопрос {q}: {scales_mapping.get(q, ['Нет маппинга'])}")

if __name__ == "__main__":
    create_simple_scales_mapping()